import { Meta } from "@storybook/blocks";

<Meta title="Workflows/Pre-application/Overview" />

# Pre-application Workflow

Pre-application advice helps applicants understand whether their proposal is likely to be approved before they submit a formal application. The workflow covers validation, optional consultation, a detailed assessment with site visits and meetings, and a review — but has **no determination stage** since no formal decision is issued.

<div style={{ display: "flex", gap: "4px", marginBottom: "32px", marginTop: "24px" }}>
  <div style={{ flex: 1, background: "#1d70b8", color: "#fff", padding: "12px 16px", borderRadius: "4px", textAlign: "center" }}>
    <strong style={{ display: "block", fontSize: "16px" }}>1. Validation</strong>
    <span style={{ fontSize: "13px", opacity: 0.9 }}>9 tasks</span>
  </div>
  <div style={{ flex: 1, background: "#4c2c92", color: "#fff", padding: "12px 16px", borderRadius: "4px", textAlign: "center" }}>
    <strong style={{ display: "block", fontSize: "16px" }}>2. Consultation</strong>
    <span style={{ fontSize: "13px", opacity: 0.9 }}>4 tasks</span>
  </div>
  <div style={{ flex: 1, background: "#d53880", color: "#fff", padding: "12px 16px", borderRadius: "4px", textAlign: "center" }}>
    <strong style={{ display: "block", fontSize: "16px" }}>3. Assessment</strong>
    <span style={{ fontSize: "13px", opacity: 0.9 }}>12 tasks</span>
  </div>
  <div style={{ flex: 1, background: "#f47738", color: "#fff", padding: "12px 16px", borderRadius: "4px", textAlign: "center" }}>
    <strong style={{ display: "block", fontSize: "16px" }}>4. Review</strong>
    <span style={{ fontSize: "13px", opacity: 0.9 }}>1 task</span>
  </div>
  <div style={{ flex: 1, background: "#b1b4b6", color: "#fff", padding: "12px 16px", borderRadius: "4px", textAlign: "center" }}>
    <strong style={{ display: "block", fontSize: "16px" }}>5. Determination</strong>
    <span style={{ fontSize: "13px", opacity: 0.9 }}>N/A</span>
  </div>
</div>

<hr />

## Stage 1: Validation

Similar to Planning Permission but without the "Confirm application requirements" subsection. Adds a "Check requested services" task specific to pre-applications.

<h4 style={{ marginTop: "24px", marginBottom: "8px", color: "#505a5f" }}>Check, tag, and confirm documents</h4>

<table style={{ width: "100%" }}>
  <thead>
    <tr><th>Task</th><th>Description</th></tr>
  </thead>
  <tbody>
    <tr><td>Review documents</td><td>Tag each uploaded document</td></tr>
    <tr><td>Check and request documents</td><td>Check if required documents are present; request missing ones</td></tr>
  </tbody>
</table>

<h4 style={{ marginTop: "24px", marginBottom: "8px", color: "#505a5f" }}>Check application details</h4>

<table style={{ width: "100%" }}>
  <thead>
    <tr><th>Task</th><th>Description</th></tr>
  </thead>
  <tbody>
    <tr><td>Check red line boundary</td><td>Verify the site boundary on the map</td></tr>
    <tr><td>Check constraints</td><td>Review planning constraints</td></tr>
    <tr><td>Check description</td><td>Confirm the proposal description is accurate</td></tr>
    <tr style={{ background: "#fef7e5" }}><td>Check requested services</td><td>Review the services the applicant has requested (pre-app only)</td></tr>
    <tr><td>Check fee</td><td>Verify the correct fee has been paid</td></tr>
  </tbody>
</table>

<h4 style={{ marginTop: "24px", marginBottom: "8px", color: "#505a5f" }}>Other validation issues</h4>

<table style={{ width: "100%" }}>
  <thead>
    <tr><th>Task</th><th>Description</th></tr>
  </thead>
  <tbody>
    <tr><td>Other validation requests</td><td>Send ad-hoc requests to the applicant</td></tr>
  </tbody>
</table>

<h4 style={{ marginTop: "24px", marginBottom: "8px", color: "#505a5f" }}>Review</h4>

<table style={{ width: "100%" }}>
  <thead>
    <tr><th>Task</th><th>Description</th></tr>
  </thead>
  <tbody>
    <tr><td>Review validation requests</td><td>Summary of all pending/resolved requests</td></tr>
    <tr><td>Send validation decision</td><td>Validate or invalidate the application</td></tr>
  </tbody>
</table>

<hr />

## Stage 2: Consultation

Unlike Planning Permission where consultation tasks are configured per application, the pre-application workflow defines its own consultation tasks. Some are initially hidden and appear after the officer determines consultation is required.

<table style={{ width: "100%" }}>
  <thead>
    <tr><th>Task</th><th>Description</th></tr>
  </thead>
  <tbody>
    <tr><td>Determine consultation requirement</td><td>Decide whether the pre-application needs consultee input</td></tr>
    <tr><td>Add and assign consultees</td><td>Select and assign consultees (hidden until consultation is required)</td></tr>
    <tr><td>Send emails to consultees</td><td>Send consultation emails (hidden until consultees assigned)</td></tr>
    <tr><td>View consultee responses</td><td>Review responses from consultees (hidden until emails sent)</td></tr>
  </tbody>
</table>

<hr />

## Stage 3: Assessment

The assessment stage is significantly larger than Planning Permission. It includes site visits, meetings, detailed planning advice, and preparation for a potential formal application.

<h4 style={{ marginTop: "24px", marginBottom: "8px", color: "#505a5f" }}>Check application</h4>

<table style={{ width: "100%" }}>
  <thead>
    <tr><th>Task</th><th>Description</th></tr>
  </thead>
  <tbody>
    <tr><td>Check application details</td><td>Review the application details post-validation</td></tr>
    <tr><td>Check consultees</td><td>Review consultee responses</td></tr>
    <tr><td>Check site history</td><td>Review previous planning applications for the site</td></tr>
  </tbody>
</table>

<h4 style={{ marginTop: "24px", marginBottom: "8px", color: "#505a5f" }}>Additional services</h4>

<table style={{ width: "100%" }}>
  <thead>
    <tr><th>Task</th><th>Description</th></tr>
  </thead>
  <tbody>
    <tr style={{ background: "#fef7e5" }}><td>Site visit</td><td>Record site visit details and findings (pre-app only)</td></tr>
    <tr style={{ background: "#fef7e5" }}><td>Meeting</td><td>Record meeting details with applicant/agent (pre-app only)</td></tr>
  </tbody>
</table>

<h4 style={{ marginTop: "24px", marginBottom: "8px", color: "#505a5f" }}>Assessment summaries</h4>

<table style={{ width: "100%" }}>
  <thead>
    <tr><th>Task</th><th>Description</th></tr>
  </thead>
  <tbody>
    <tr style={{ background: "#fef7e5" }}><td>Site and surroundings</td><td>Describe the site context and surroundings (replaces "Check publicity")</td></tr>
    <tr style={{ background: "#fef7e5" }}><td>Planning considerations and advice</td><td>Write detailed planning advice for the applicant</td></tr>
    <tr style={{ background: "#fef7e5" }}><td>Suggest heads of terms</td><td>Propose heads of terms for any section 106 agreement</td></tr>
    <tr style={{ background: "#fef7e5" }}><td>Summary of advice</td><td>Write the overall summary of pre-application advice</td></tr>
  </tbody>
</table>

<h4 style={{ marginTop: "24px", marginBottom: "8px", color: "#505a5f" }}>Complete assessment</h4>

<table style={{ width: "100%" }}>
  <thead>
    <tr><th>Task</th><th>Description</th></tr>
  </thead>
  <tbody>
    <tr style={{ background: "#fef7e5" }}><td>Choose application type</td><td>Recommend the formal application type for the applicant</td></tr>
    <tr style={{ background: "#fef7e5" }}><td>Check and add requirements</td><td>List what the applicant will need for a formal submission</td></tr>
    <tr style={{ background: "#fef7e5" }}><td>Review and submit pre-application</td><td>Final review and submission of the pre-application advice</td></tr>
  </tbody>
</table>

<hr />

## Stage 4: Review

<table style={{ width: "100%" }}>
  <thead>
    <tr><th>Task</th><th>Description</th></tr>
  </thead>
  <tbody>
    <tr><td>View recommendation</td><td>Senior officer reviews the pre-application advice</td></tr>
  </tbody>
</table>

<hr />

## Stage 5: Determination

<p style={{ padding: "12px 16px", background: "#f3f2f1", fontSize: "14px" }}>
  Pre-applications do not have a determination stage. The advice is issued directly after review.
</p>

<hr />

## Compared to Planning Permission

<p style={{ marginBottom: "16px" }}>Highlighted rows show tasks unique to pre-applications. Tasks shared with Planning Permission use the same UI patterns.</p>

<table style={{ width: "100%" }}>
  <thead>
    <tr>
      <th>Area</th>
      <th>Planning Permission</th>
      <th>Pre-application</th>
    </tr>
  </thead>
  <tbody>
    <tr><td>Validation</td><td>14 tasks incl. CIL, EIA, ownership cert</td><td>9 tasks — no "Confirm requirements" section; adds "Check requested services"</td></tr>
    <tr><td>Consultation</td><td>Tasks configured per application</td><td>4 explicit tasks with progressive disclosure (hidden → visible)</td></tr>
    <tr><td>Assessment</td><td>5 tasks focused on policy review</td><td>12 tasks incl. site visit, meeting, planning advice, heads of terms</td></tr>
    <tr><td>Review</td><td>View recommendation</td><td>View recommendation (same)</td></tr>
    <tr><td>Determination</td><td>Publish determination</td><td>None — advice issued after review</td></tr>
  </tbody>
</table>
